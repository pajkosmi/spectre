<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: CurvedScalarWave::Worldtube Namespace Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceCurvedScalarWave_1_1Worldtube.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">CurvedScalarWave::Worldtube Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The set of utilities for performing <a class="el" href="namespaceCurvedScalarWave.html" title="Items related to evolving a scalar wave on a curved background.">CurvedScalarWave</a> evolution with a worldtube excision scheme.  
<a href="namespaceCurvedScalarWave_1_1Worldtube.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceCurvedScalarWave_1_1Worldtube_1_1OptionTags"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCurvedScalarWave_1_1Worldtube_1_1OptionTags.html">OptionTags</a></td></tr>
<tr class="memdesc:namespaceCurvedScalarWave_1_1Worldtube_1_1OptionTags"><td class="mdescLeft">&#160;</td><td class="mdescRight">Option tags for the worldtube. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceCurvedScalarWave_1_1Worldtube_1_1Tags"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCurvedScalarWave_1_1Worldtube_1_1Tags.html">Tags</a></td></tr>
<tr class="memdesc:namespaceCurvedScalarWave_1_1Worldtube_1_1Tags"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespaceCurvedScalarWave_1_1Worldtube_1_1Tags.html" title="Tags related to the worldtube.">Tags</a> related to the worldtube. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCurvedScalarWave_1_1Worldtube_1_1Registration.html">Registration</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCurvedScalarWave_1_1Worldtube_1_1TimeDerivativeMutator.html">TimeDerivativeMutator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the time derivative of <code>Psi0</code>, the constant coefficient of the expansion of <code>Psi</code>.  <a href="structCurvedScalarWave_1_1Worldtube_1_1TimeDerivativeMutator.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCurvedScalarWave_1_1Worldtube_1_1WorldtubeSingleton.html">WorldtubeSingleton</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The singleton component that represents the worldtube.  <a href="structCurvedScalarWave_1_1Worldtube_1_1WorldtubeSingleton.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a65731f63eaf841bf44a9121a2c9aaa20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCurvedScalarWave_1_1Worldtube.html#a65731f63eaf841bf44a9121a2c9aaa20">puncture_field</a> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; Variables&lt; tmpl::list&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, <a class="el" href="structTags_1_1dt.html">::Tags::dt</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a> &gt;, <a class="el" href="structTags_1_1deriv.html">::Tags::deriv</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, tmpl::size_t&lt; 3 &gt;, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &gt; &gt; * &gt; result, const tnsr::I&lt; <a class="el" href="classDataVector.html">DataVector</a>, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;coords, const double time, const double orbital_radius, const double bh_mass, size_t order)</td></tr>
<tr class="memdesc:a65731f63eaf841bf44a9121a2c9aaa20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the puncture/singular field \(\Psi^\mathcal{P}\) of a scalar charge in circular orbit around a Schwarzschild black hole as described in <a class="el" href="citelist.html#CITEREF_Detweiler2003">[50]</a>.  <a href="namespaceCurvedScalarWave_1_1Worldtube.html#a65731f63eaf841bf44a9121a2c9aaa20">More...</a><br /></td></tr>
<tr class="separator:a65731f63eaf841bf44a9121a2c9aaa20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d317c1d511a2cced0a3f5628d23ea5b"><td class="memItemLeft" align="right" valign="top"><a id="a9d317c1d511a2cced0a3f5628d23ea5b" name="a9d317c1d511a2cced0a3f5628d23ea5b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>puncture_field_0</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; Variables&lt; tmpl::list&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, <a class="el" href="structTags_1_1dt.html">::Tags::dt</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a> &gt;, <a class="el" href="structTags_1_1deriv.html">::Tags::deriv</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, tmpl::size_t&lt; 3 &gt;, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &gt; &gt; * &gt; result, const tnsr::I&lt; <a class="el" href="classDataVector.html">DataVector</a>, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;coords, const double time, const double orbital_radius, const double bh_mass)</td></tr>
<tr class="memdesc:a9d317c1d511a2cced0a3f5628d23ea5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the puncture/singular field \(\Psi^\mathcal{P}\) of a scalar charge in circular orbit around a Schwarzschild black hole as described in <a class="el" href="citelist.html#CITEREF_Detweiler2003">[50]</a> expanded to order 0 in geodesic distance. <br /></td></tr>
<tr class="separator:a9d317c1d511a2cced0a3f5628d23ea5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934bccdad9e5f9f1a489071c3251d6ba"><td class="memItemLeft" align="right" valign="top"><a id="a934bccdad9e5f9f1a489071c3251d6ba" name="a934bccdad9e5f9f1a489071c3251d6ba"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>puncture_field_1</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; Variables&lt; tmpl::list&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, <a class="el" href="structTags_1_1dt.html">::Tags::dt</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a> &gt;, <a class="el" href="structTags_1_1deriv.html">::Tags::deriv</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, tmpl::size_t&lt; 3 &gt;, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &gt; &gt; * &gt; result, const tnsr::I&lt; <a class="el" href="classDataVector.html">DataVector</a>, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;coords, const double time, const double orbital_radius, const double bh_mass)</td></tr>
<tr class="memdesc:a934bccdad9e5f9f1a489071c3251d6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the puncture/singular field \(\Psi^\mathcal{P}\) of a scalar charge in circular orbit around a Schwarzschild black hole as described in <a class="el" href="citelist.html#CITEREF_Detweiler2003">[50]</a> expanded to order 1 in geodesic distance. <br /></td></tr>
<tr class="separator:a934bccdad9e5f9f1a489071c3251d6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2790050053fabb01fd686f907836cb"><td class="memItemLeft" align="right" valign="top"><a id="aaa2790050053fabb01fd686f907836cb" name="aaa2790050053fabb01fd686f907836cb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>puncture_field_2</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; Variables&lt; tmpl::list&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, <a class="el" href="structTags_1_1dt.html">::Tags::dt</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a> &gt;, <a class="el" href="structTags_1_1deriv.html">::Tags::deriv</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, tmpl::size_t&lt; 3 &gt;, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &gt; &gt; * &gt; result, const tnsr::I&lt; <a class="el" href="classDataVector.html">DataVector</a>, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;coords, const double time, const double orbital_radius, const double bh_mass)</td></tr>
<tr class="memdesc:aaa2790050053fabb01fd686f907836cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the puncture/singular field \(\Psi^\mathcal{P}\) of a scalar charge in circular orbit around a Schwarzschild black hole as described in <a class="el" href="citelist.html#CITEREF_Detweiler2003">[50]</a> expanded to order 2 in geodesic distance. <br /></td></tr>
<tr class="separator:aaa2790050053fabb01fd686f907836cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The set of utilities for performing <a class="el" href="namespaceCurvedScalarWave.html" title="Items related to evolving a scalar wave on a curved background.">CurvedScalarWave</a> evolution with a worldtube excision scheme. </p>
<h3>Details</h3>
<p >The worldtube excision scheme is a method that aims to enable NR evolutions of intermediate mass ratio binary black hole simulations. In standard BBH simulations two excision spheres are cut out from the domain within the apparent horizons of the respective black holes. For larger mass ratios, this introduces a scale disparity in the evolution system because the small grid spacing in the elements near the smaller black hole constrain the time step to be orders of magnitude smaller than near the larger black hole due to the CFL condition. The worldtube excision scheme avoids this by excising a much larger region (the worldtube) around the smaller black hole. Since the excision boundary no longer lies within the apparent horizon, boundary conditions are required. These are derived by approximating the solution inside the worldtube using a perturbative solution - a black hole perturbed by another black hole. The solution is calibrated by the evolved metric on the worldtube boundary and in turn provides boundary conditions to the evolution system.</p>
<p >Here, we test this scheme using a toy problem of a scalar charge in circular orbit around a Schwarzschild black hole. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a65731f63eaf841bf44a9121a2c9aaa20" name="a65731f63eaf841bf44a9121a2c9aaa20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65731f63eaf841bf44a9121a2c9aaa20">&#9670;&nbsp;</a></span>puncture_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CurvedScalarWave::Worldtube::puncture_field </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; Variables&lt; tmpl::list&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, <a class="el" href="structTags_1_1dt.html">::Tags::dt</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a> &gt;, <a class="el" href="structTags_1_1deriv.html">::Tags::deriv</a>&lt; <a class="el" href="structCurvedScalarWave_1_1Tags_1_1Psi.html">CurvedScalarWave::Tags::Psi</a>, tmpl::size_t&lt; 3 &gt;, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &gt; &gt; * &gt;&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const tnsr::I&lt; <a class="el" href="classDataVector.html">DataVector</a>, 3, <a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>orbital_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>bh_mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the puncture/singular field \(\Psi^\mathcal{P}\) of a scalar charge in circular orbit around a Schwarzschild black hole as described in <a class="el" href="citelist.html#CITEREF_Detweiler2003">[50]</a>. </p>
<h3>Details</h3>
<p >The field is computed using a Detweiler-Whiting singular Green's function and perturbatively expanded in the geodesic distance from the particle. It solves the inhomogeneous wave equation</p>
<p class="formulaDsp">
\begin{align*} \Box \Psi^\mathcal{P} = -4 \pi q \int \sqrt{-g} \delta^4(x^i, z(\tau)) d \tau \end{align*}
</p>
<p >where \(q\) is the scalar charge and \(z(\tau)\) is the worldline of the particle. The expression is expanded up to a certain order in geodesic distance and transformed to Kerr-Schild coordinates.</p>
<p >The function given here assumes that the particle has scalar charge \(q=1\) and is on a fixed geodesic orbit with \(z(t) = (R \cos{\omega t}, R \sin{\omega t}, 0)\) around a Schwarzschild black hole, where \(R\) is the orbital radius and \( \omega = R^{-3/2} \). It returns the singular field at the requested coordinates as well as its time and spatial derivative.</p>
<dl class="section note"><dt>Note</dt><dd>The expressions were computed with Mathematica and optimized by applying common subexpression elimination with sympy. The memory allocations of temporaries were optimized manually. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceCurvedScalarWave.html">CurvedScalarWave</a></li><li class="navelem"><a class="el" href="namespaceCurvedScalarWave_1_1Worldtube.html">Worldtube</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
