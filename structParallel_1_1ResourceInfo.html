<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: Parallel::ResourceInfo&lt; Metavariables &gt; Struct Template Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structParallel_1_1ResourceInfo.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="structParallel_1_1ResourceInfo-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Parallel::ResourceInfo&lt; Metavariables &gt; Struct Template Reference<div class="ingroups"><a class="el" href="group__ParallelGroup.html">Parallelization</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Holds resource info for all singletons and for avoiding placing array elements/singletons on the global proc 0.  
 <a href="structParallel_1_1ResourceInfo.html#details">More...</a></p>

<p><code>#include &lt;ResourceInfo.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structParallel_1_1ResourceInfo_1_1AvoidGlobalProc0.html">AvoidGlobalProc0</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structParallel_1_1ResourceInfo_1_1Singletons.html">Singletons</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a665b79ddd3ae29c4b03a446a3508ac47"><td class="memItemLeft" align="right" valign="top"><a id="a665b79ddd3ae29c4b03a446a3508ac47" name="a665b79ddd3ae29c4b03a446a3508ac47"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>options</b> = tmpl::push_front&lt; tmpl::conditional_t&lt; tmpl::size&lt; singletons &gt;<a class="el" href="group__UtilitiesGroup.html#ga2cb8822c810d5eec9a7ecc6d271bda8f">::value</a> !=0, tmpl::list&lt; <a class="el" href="structParallel_1_1ResourceInfo_1_1Singletons.html">Singletons</a> &gt;, tmpl::list&lt;&gt; &gt;, <a class="el" href="structParallel_1_1ResourceInfo_1_1AvoidGlobalProc0.html">AvoidGlobalProc0</a> &gt;</td></tr>
<tr class="separator:a665b79ddd3ae29c4b03a446a3508ac47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac167c2e035e84fb3babef61f29c26350"><td class="memItemLeft" align="right" valign="top"><a id="ac167c2e035e84fb3babef61f29c26350" name="ac167c2e035e84fb3babef61f29c26350"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ResourceInfo</b> (const bool <a class="el" href="structParallel_1_1ResourceInfo.html#a35c8a3d4ea60befbb62a2324c4ba8bf8">avoid_global_proc_0</a>, const <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt; <a class="el" href="structParallel_1_1SingletonPack.html">SingletonPack</a>&lt; singletons &gt; &gt; &amp;singleton_pack, const <a class="el" href="structOptions_1_1Context.html">Options::Context</a> &amp;context={})</td></tr>
<tr class="memdesc:ac167c2e035e84fb3babef61f29c26350"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main constructor. All other constructors that take options will call this one. This constructor holds all checks able to be done during option parsing. <br /></td></tr>
<tr class="separator:ac167c2e035e84fb3babef61f29c26350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae08cf3d9eb684b75cce5eeea1371847"><td class="memItemLeft" align="right" valign="top"><a id="aae08cf3d9eb684b75cce5eeea1371847" name="aae08cf3d9eb684b75cce5eeea1371847"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ResourceInfo</b> (const bool <a class="el" href="structParallel_1_1ResourceInfo.html#a35c8a3d4ea60befbb62a2324c4ba8bf8">avoid_global_proc_0</a>, const <a class="el" href="structOptions_1_1Context.html">Options::Context</a> &amp;context={})</td></tr>
<tr class="memdesc:aae08cf3d9eb684b75cce5eeea1371847"><td class="mdescLeft">&#160;</td><td class="mdescRight">This constructor is used when only <a class="el" href="structParallel_1_1ResourceInfo_1_1AvoidGlobalProc0.html">AvoidGlobalProc0</a> is specified, but no SingletonInfoHolders are specified. Calls the main constructor with an empty <a class="el" href="structParallel_1_1SingletonPack.html">SingletonPack</a>. <br /></td></tr>
<tr class="separator:aae08cf3d9eb684b75cce5eeea1371847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45dfa19cf448bff4b85bd469c8ba3262"><td class="memItemLeft" align="right" valign="top"><a id="a45dfa19cf448bff4b85bd469c8ba3262" name="a45dfa19cf448bff4b85bd469c8ba3262"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ResourceInfo</b> (const <a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;)=default</td></tr>
<tr class="separator:a45dfa19cf448bff4b85bd469c8ba3262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c595dcd6b9177f5134a1859a615f92"><td class="memItemLeft" align="right" valign="top"><a id="aa6c595dcd6b9177f5134a1859a615f92" name="aa6c595dcd6b9177f5134a1859a615f92"></a>
<a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;)=default</td></tr>
<tr class="separator:aa6c595dcd6b9177f5134a1859a615f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34ef17b5dd00f5fd85ebb074aa9fb2e"><td class="memItemLeft" align="right" valign="top"><a id="ad34ef17b5dd00f5fd85ebb074aa9fb2e" name="ad34ef17b5dd00f5fd85ebb074aa9fb2e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ResourceInfo</b> (<a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;&amp;)=default</td></tr>
<tr class="separator:ad34ef17b5dd00f5fd85ebb074aa9fb2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abada945e66035905f86b22ef1dadadf9"><td class="memItemLeft" align="right" valign="top"><a id="abada945e66035905f86b22ef1dadadf9" name="abada945e66035905f86b22ef1dadadf9"></a>
<a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a> &amp;&amp;)=default</td></tr>
<tr class="separator:abada945e66035905f86b22ef1dadadf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af47f377086e7f67525322749cddd73a2"><td class="memItemLeft" align="right" valign="top"><a id="af47f377086e7f67525322749cddd73a2" name="af47f377086e7f67525322749cddd73a2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pup</b> (PUP::er &amp;p)</td></tr>
<tr class="separator:af47f377086e7f67525322749cddd73a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c8a3d4ea60befbb62a2324c4ba8bf8"><td class="memItemLeft" align="right" valign="top"><a id="a35c8a3d4ea60befbb62a2324c4ba8bf8" name="a35c8a3d4ea60befbb62a2324c4ba8bf8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>avoid_global_proc_0</b> () const</td></tr>
<tr class="memdesc:a35c8a3d4ea60befbb62a2324c4ba8bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether we should avoid placing array elements and singletons on the global zeroth proc. Default <code>false</code>. <br /></td></tr>
<tr class="separator:a35c8a3d4ea60befbb62a2324c4ba8bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfbb91962878423a8e7c55bab03ec01f"><td class="memTemplParams" colspan="2"><a id="adfbb91962878423a8e7c55bab03ec01f" name="adfbb91962878423a8e7c55bab03ec01f"></a>
template&lt;typename Component &gt; </td></tr>
<tr class="memitem:adfbb91962878423a8e7c55bab03ec01f"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><b>get_singleton_info</b> () const</td></tr>
<tr class="memdesc:adfbb91962878423a8e7c55bab03ec01f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a <a class="el" href="structParallel_1_1SingletonInfoHolder.html" title="Holds resource info for a single singleton component.">SingletonInfoHolder</a> corresponding to <code>Component</code> <br /></td></tr>
<tr class="separator:adfbb91962878423a8e7c55bab03ec01f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba063848e88d207bdc8b3421ab1fca3"><td class="memItemLeft" align="right" valign="top"><a id="aaba063848e88d207bdc8b3421ab1fca3" name="aaba063848e88d207bdc8b3421ab1fca3"></a>
const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_set.html">std::unordered_set</a>&lt; size_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>procs_to_ignore</b> () const</td></tr>
<tr class="memdesc:aaba063848e88d207bdc8b3421ab1fca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_set.html">std::unordered_set</a>&lt;size_t&gt;</code> of processors that array components should avoid placing elements on. This should be passed to the <code>allocate_array</code> function of the array component. <br /></td></tr>
<tr class="separator:aaba063848e88d207bdc8b3421ab1fca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350c64511a08ec0d92804b780cb4beb4"><td class="memItemLeft" align="right" valign="top"><a id="a350c64511a08ec0d92804b780cb4beb4" name="a350c64511a08ec0d92804b780cb4beb4"></a>
const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/set.html">std::set</a>&lt; size_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>procs_available_for_elements</b> () const</td></tr>
<tr class="memdesc:a350c64511a08ec0d92804b780cb4beb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/set.html">std::set</a>&lt;size_t&gt;</code> that has all processors available to put elements on, meaning processors that aren't ignored. <br /></td></tr>
<tr class="separator:a350c64511a08ec0d92804b780cb4beb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec14062fa7af88072667d0afe952173"><td class="memTemplParams" colspan="2"><a id="a4ec14062fa7af88072667d0afe952173" name="a4ec14062fa7af88072667d0afe952173"></a>
template&lt;typename Component &gt; </td></tr>
<tr class="memitem:a4ec14062fa7af88072667d0afe952173"><td class="memTemplItemLeft" align="right" valign="top">size_t&#160;</td><td class="memTemplItemRight" valign="bottom"><b>proc_for</b> () const</td></tr>
<tr class="memdesc:a4ec14062fa7af88072667d0afe952173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the proc that the singleton <code>Component</code> should be placed on. <br /></td></tr>
<tr class="separator:a4ec14062fa7af88072667d0afe952173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3d0426c15ea234cf21f678ade72b8a8"><td class="memTemplParams" colspan="2">template&lt;typename Cache &gt; </td></tr>
<tr class="memitem:af3d0426c15ea234cf21f678ade72b8a8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structParallel_1_1ResourceInfo.html#af3d0426c15ea234cf21f678ade72b8a8">build_singleton_map</a> (const Cache &amp;cache)</td></tr>
<tr class="memdesc:af3d0426c15ea234cf21f678ade72b8a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually builds the singleton map and allocates all the singletons.  <a href="structParallel_1_1ResourceInfo.html#af3d0426c15ea234cf21f678ade72b8a8">More...</a><br /></td></tr>
<tr class="separator:af3d0426c15ea234cf21f678ade72b8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a0ac5389180ea651bb58674057845dfd0"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="namespaceOptions.html#aa61c7f41f21afa7646811456f673be89">Options::String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structParallel_1_1ResourceInfo.html#a0ac5389180ea651bb58674057845dfd0">help</a></td></tr>
<tr class="separator:a0ac5389180ea651bb58674057845dfd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a13171a3f745c38f7f3753e9ff82b441a"><td class="memTemplParams" colspan="2"><a id="a13171a3f745c38f7f3753e9ff82b441a" name="a13171a3f745c38f7f3753e9ff82b441a"></a>
template&lt;typename Metavars &gt; </td></tr>
<tr class="memitem:a13171a3f745c38f7f3753e9ff82b441a"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><b>operator==</b> (const <a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a>&lt; Metavars &gt; &amp;lhs, const <a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a>&lt; Metavars &gt; &amp;rhs)</td></tr>
<tr class="separator:a13171a3f745c38f7f3753e9ff82b441a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename Metavariables&gt;<br />
struct Parallel::ResourceInfo&lt; Metavariables &gt;</div><p >Holds resource info for all singletons and for avoiding placing array elements/singletons on the global proc 0. </p>
<h3>Details</h3>
<p >This can be used for placing all singletons in an executable.</p>
<p >If you have no singletons, you'll need the following block in the input file (where you can set the value of <a class="el" href="structParallel_1_1ResourceInfo_1_1AvoidGlobalProc0.html">AvoidGlobalProc0</a> to true or false):</p>
<div class="fragment"><div class="line">ResourceInfo:</div>
<div class="line">  AvoidGlobalProc0: true</div>
</div><!-- fragment --><p >If you have singletons, but do not want to assign any of them to a specific proc or be exclusive on a proc, you'll need the following block in the input file (where you can set the value of <a class="el" href="structParallel_1_1ResourceInfo_1_1AvoidGlobalProc0.html">AvoidGlobalProc0</a> to true or false):</p>
<div class="fragment"><div class="line">ResourceInfo:</div>
<div class="line">  AvoidGlobalProc0: true</div>
<div class="line">  Singletons: Auto</div>
</div><!-- fragment --><p >Otherwise, you will need to specify a block in the input file as below, where you will need to specify the options for each singleton:</p>
<div class="fragment"><div class="line">ResourceInfo:</div>
<div class="line">  AvoidGlobalProc0: true</div>
<div class="line">  Singletons:</div>
<div class="line">    MySingleton1:</div>
<div class="line">      Proc: 2</div>
<div class="line">      Exclusive: true</div>
<div class="line">    MySingleton2: Auto</div>
</div><!-- fragment --><p >where <code>MySingleton1</code> is the <code><a class="el" href="group__PrettyTypeGroup.html#gac698d0d763b59b714fca6ed84376eb92" title="Return the result of the name() member of a class. If a class doesn&#39;t have a name() member,...">pretty_type::name</a></code> of the singleton component and the options for each singleton are described in <code><a class="el" href="structParallel_1_1SingletonInfoHolder.html" title="Holds resource info for a single singleton component.">Parallel::SingletonInfoHolder</a></code> (You can use <code>Auto</code> for each singleton that you want to have it's proc determined automatically and be non-exclusive, like <code>MySingleton2</code>).</p>
<p >Several consistency checks are done during option parsing to avoid user error. However, some checks can't be done during option parsing because the number of nodes/procs is needed to determine if there is an inconsistency. These checks are done during runtime, just before the map of singletons is created.</p>
<p >To automatically place singletons, we use a custom algorithm that will distribute singletons evenly over the number of nodes, and evenly over the procs on a node. This will help keep communication costs down by distributing the workload over all of the communication cores (one communication core per charm node), and ensure that our resources are being maximally utilized (i.e. one core doesn't have all the singletons on it).</p>
<p >Defining some terminology for singletons: <code>requested</code> means that a specific processor was requested in the input file; <code>auto</code> means that the processor should be chosen automatically; <code>exclusive</code> means that no other singletons or array elements should be placed on this singleton's processor; <code>nonexclusive</code> means that you <em>can</em> place other singletons or array elements on this singleton's processor. The algorithm that distributes the singletons is as follows:</p>
<ol type="1">
<li>Allocate all singletons that <code>requested</code> specific processors, both <code>exclusive</code> and <code>nonexclusive</code>. This is done during option parsing.</li>
<li>Allocate <code>auto exclusive</code> singletons, distributing the total number of <code>exclusive</code> singletons (<code>auto</code> + <code>requested</code>) as evenly as possibly over the number of nodes. We say "as evenly as possible" because this depends on the <code>requested exclusive</code> singletons. For example, if we have 4 nodes and 5 cores per node, the number of <code>requested exclusive</code> singletons on each node is (0, 1, 4, 1), and we have 3 <code>auto exclusive</code> singletons to place, the best distribution of <code>exclusive</code> singletons we can achieve given our constraints is (2, 2, 4, 1). Clearly this is not the <em>most</em> evenly distributed the <code>exclusive</code> singletons could be. However, this <em>is</em> the most evenly distributed they could be given the starting distribution from the input file.</li>
<li>Allocate <code>auto nonexclusive</code> singletons, distributing the total number of <code>nonexclusive</code> singletons (<code>auto</code> + <code>requested</code>): First, as evenly as possibly over the number of nodes. Then, on each node, distributing the singletons as evenly as possibly over the number of processors on that node. The same disclaimer about "as evenly as possibly" from the previous step applies here.</li>
</ol>
<p >The goal of this algorithm is to mimic, as best as possible, how a human would distribute this workload. It isn't perfect, but is a significant improvement over placing singletons on one proc after another starting from global proc 0. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="af3d0426c15ea234cf21f678ade72b8a8" name="af3d0426c15ea234cf21f678ade72b8a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3d0426c15ea234cf21f678ade72b8a8">&#9670;&nbsp;</a></span>build_singleton_map()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Metavariables &gt; </div>
<div class="memtemplate">
template&lt;typename Cache &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="structParallel_1_1ResourceInfo.html">Parallel::ResourceInfo</a>&lt; Metavariables &gt;::build_singleton_map </td>
          <td>(</td>
          <td class="paramtype">const Cache &amp;&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Actually builds the singleton map and allocates all the singletons. </p>
<h3>Details</h3>
<p >This could be done in the constructor, however, since we need the number of nodes to do some sanity checks, it can't. If an executable is run with the &ndash;check-options flag, we will be running on 1 proc and 1 node so some of the checks done in this function would fail. Unfortunately, that means the checks that require knowing the number of nodes now occur at runtime instead of option parsing. This is why the <code>singleton_map_has_been_set_</code> bool is necessary and why we check if this function has been called in most other member functions.</p>
<p >To avoid a cyclic dependency between the <a class="el" href="classParallel_1_1GlobalCache.html" title="A Charm++ chare that caches constant data once per Charm++ node or non-constant data once per Charm++...">GlobalCache</a> and <a class="el" href="structParallel_1_1ResourceInfo.html" title="Holds resource info for all singletons and for avoiding placing array elements/singletons on the glob...">ResourceInfo</a>, we template this function rather than explicitly use the <a class="el" href="classParallel_1_1GlobalCache.html" title="A Charm++ chare that caches constant data once per Charm++ node or non-constant data once per Charm++...">GlobalCache</a> because the <a class="el" href="classParallel_1_1GlobalCache.html" title="A Charm++ chare that caches constant data once per Charm++ node or non-constant data once per Charm++...">GlobalCache</a> depends on <a class="el" href="structParallel_1_1ResourceInfo.html" title="Holds resource info for all singletons and for avoiding placing array elements/singletons on the glob...">ResourceInfo</a></p>
<p >This function should only be called once. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0ac5389180ea651bb58674057845dfd0" name="a0ac5389180ea651bb58674057845dfd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac5389180ea651bb58674057845dfd0">&#9670;&nbsp;</a></span>help</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Metavariables &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="namespaceOptions.html#aa61c7f41f21afa7646811456f673be89">Options::String</a> <a class="el" href="structParallel_1_1ResourceInfo.html">Parallel::ResourceInfo</a>&lt; Metavariables &gt;::help</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">      <span class="stringliteral">&quot;Resource options for a simulation. This information will be used when &quot;</span></div>
<div class="line">      <span class="stringliteral">&quot;placing Array and Singleton parallel components on the requested &quot;</span></div>
<div class="line">      <span class="stringliteral">&quot;resources.&quot;</span>}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/Parallel/ResourceInfo.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceParallel.html">Parallel</a></li><li class="navelem"><a class="el" href="structParallel_1_1ResourceInfo.html">ResourceInfo</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
