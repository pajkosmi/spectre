<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: domain::CoordinateMaps::TimeDependent::Shape Class Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">domain::CoordinateMaps::TimeDependent::Shape Class Reference<div class="ingroups"><a class="el" href="group__CoordMapsTimeDependentGroup.html">Coordinate Maps, Time-dependent</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Distorts a distribution of points radially according to a spherical harmonic expansion while preserving angles.  
 <a href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html#details">More...</a></p>

<p><code>#include &lt;Shape.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9f3dd1e346cbaca79b515959c6353976"><td class="memItemLeft" align="right" valign="top"><a id="a9f3dd1e346cbaca79b515959c6353976" name="a9f3dd1e346cbaca79b515959c6353976"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>FunctionsOfTimeMap</b> = <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">std::unordered_map</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>, <a class="elRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr</a>&lt; <a class="el" href="classdomain_1_1FunctionsOfTime_1_1FunctionOfTime.html">domain::FunctionsOfTime::FunctionOfTime</a> &gt; &gt;</td></tr>
<tr class="separator:a9f3dd1e346cbaca79b515959c6353976"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af79d3451df6ee539dfa69e1d1168570a"><td class="memItemLeft" align="right" valign="top"><a id="af79d3451df6ee539dfa69e1d1168570a" name="af79d3451df6ee539dfa69e1d1168570a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Shape</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; &amp;center, size_t l_max, size_t m_max, <a class="elRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr</a>&lt; <a class="el" href="classdomain_1_1CoordinateMaps_1_1ShapeMapTransitionFunctions_1_1ShapeMapTransitionFunction.html">ShapeMapTransitionFunctions::ShapeMapTransitionFunction</a> &gt; transition_func, <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> shape_function_of_time_name, <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> &gt; size_function_of_time_name=std::nullopt)</td></tr>
<tr class="separator:af79d3451df6ee539dfa69e1d1168570a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe284f4a100936f911deb466c9ce494"><td class="memItemLeft" align="right" valign="top"><a id="aafe284f4a100936f911deb466c9ce494" name="aafe284f4a100936f911deb466c9ce494"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Shape</b> (<a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;&amp;)=default</td></tr>
<tr class="separator:aafe284f4a100936f911deb466c9ce494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad511c92b2ac051f2f62e4fc45419e443"><td class="memItemLeft" align="right" valign="top"><a id="ad511c92b2ac051f2f62e4fc45419e443" name="ad511c92b2ac051f2f62e4fc45419e443"></a>
<a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;&amp;)=default</td></tr>
<tr class="separator:ad511c92b2ac051f2f62e4fc45419e443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834cf220f42427c1ea25c47cbba326eb"><td class="memItemLeft" align="right" valign="top"><a id="a834cf220f42427c1ea25c47cbba326eb" name="a834cf220f42427c1ea25c47cbba326eb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Shape</b> (const <a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;rhs)</td></tr>
<tr class="separator:a834cf220f42427c1ea25c47cbba326eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2384c5dfade89d02f3d10365098dba56"><td class="memItemLeft" align="right" valign="top"><a id="a2384c5dfade89d02f3d10365098dba56" name="a2384c5dfade89d02f3d10365098dba56"></a>
<a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;rhs)</td></tr>
<tr class="separator:a2384c5dfade89d02f3d10365098dba56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476fa24138c31eacde38169c5d93c948"><td class="memTemplParams" colspan="2"><a id="a476fa24138c31eacde38169c5d93c948" name="a476fa24138c31eacde38169c5d93c948"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a476fa24138c31eacde38169c5d93c948"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3 &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>operator()</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords, double time, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">FunctionsOfTimeMap</a> &amp;functions_of_time) const</td></tr>
<tr class="separator:a476fa24138c31eacde38169c5d93c948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac7b0d42b8a5c1789af70c2af07ba9be"><td class="memItemLeft" align="right" valign="top"><a id="aac7b0d42b8a5c1789af70c2af07ba9be" name="aac7b0d42b8a5c1789af70c2af07ba9be"></a>
<a class="elRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>inverse</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; double, 3 &gt; &amp;target_coords, double time, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">FunctionsOfTimeMap</a> &amp;functions_of_time) const</td></tr>
<tr class="separator:aac7b0d42b8a5c1789af70c2af07ba9be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f14a2eeaeafd013749b1357c4ea0e0"><td class="memTemplParams" colspan="2"><a id="a49f14a2eeaeafd013749b1357c4ea0e0" name="a49f14a2eeaeafd013749b1357c4ea0e0"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a49f14a2eeaeafd013749b1357c4ea0e0"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3 &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>frame_velocity</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords, double time, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">FunctionsOfTimeMap</a> &amp;functions_of_time) const</td></tr>
<tr class="separator:a49f14a2eeaeafd013749b1357c4ea0e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5665830fb389e642a6b130c0ca4ad132"><td class="memTemplParams" colspan="2"><a id="a5665830fb389e642a6b130c0ca4ad132" name="a5665830fb389e642a6b130c0ca4ad132"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a5665830fb389e642a6b130c0ca4ad132"><td class="memTemplItemLeft" align="right" valign="top">tnsr::Ij&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3, <a class="el" href="structFrame_1_1NoFrame.html">Frame::NoFrame</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>jacobian</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords, double time, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">FunctionsOfTimeMap</a> &amp;functions_of_time) const</td></tr>
<tr class="separator:a5665830fb389e642a6b130c0ca4ad132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab01844acc66c88ced9f8ee56332ea23a"><td class="memTemplParams" colspan="2"><a id="ab01844acc66c88ced9f8ee56332ea23a" name="ab01844acc66c88ced9f8ee56332ea23a"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:ab01844acc66c88ced9f8ee56332ea23a"><td class="memTemplItemLeft" align="right" valign="top">tnsr::Ij&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3, <a class="el" href="structFrame_1_1NoFrame.html">Frame::NoFrame</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>inv_jacobian</b> (const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords, double time, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/unordered_map.html">FunctionsOfTimeMap</a> &amp;functions_of_time) const</td></tr>
<tr class="separator:ab01844acc66c88ced9f8ee56332ea23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a430f4b2b634ef63601a9ab4b7d58e80f"><td class="memItemLeft" align="right" valign="top"><a id="a430f4b2b634ef63601a9ab4b7d58e80f" name="a430f4b2b634ef63601a9ab4b7d58e80f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pup</b> (PUP::er &amp;p)</td></tr>
<tr class="separator:a430f4b2b634ef63601a9ab4b7d58e80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a397538f91293a366a5638696b4dbfb1c"><td class="memItemLeft" align="right" valign="top"><a id="a397538f91293a366a5638696b4dbfb1c" name="a397538f91293a366a5638696b4dbfb1c"></a>
static bool&#160;</td><td class="memItemRight" valign="bottom"><b>is_identity</b> ()</td></tr>
<tr class="separator:a397538f91293a366a5638696b4dbfb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:aaadde85babbecc0118e9f306f711930e"><td class="memItemLeft" align="right" valign="top"><a id="aaadde85babbecc0118e9f306f711930e" name="aaadde85babbecc0118e9f306f711930e"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>dim</b> = 3</td></tr>
<tr class="separator:aaadde85babbecc0118e9f306f711930e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a93e5f502c8966585376afcaf8a38aaef"><td class="memItemLeft" align="right" valign="top"><a id="a93e5f502c8966585376afcaf8a38aaef" name="a93e5f502c8966585376afcaf8a38aaef"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (const <a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;lhs, const <a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a> &amp;rhs)</td></tr>
<tr class="separator:a93e5f502c8966585376afcaf8a38aaef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Distorts a distribution of points radially according to a spherical harmonic expansion while preserving angles. </p>
<h3>Details</h3>
<p >Given a point with cartesian coordinates \(\xi^i\), let the polar coordinates \((r, \theta, \phi)\) with respect to a center \(x_c^i\) be defined in the usual way: </p><p class="formulaDsp">
\begin{align} \xi^0 - x_c^0 &amp;= r sin(\theta) cos(\phi)\\ \xi^1 - x_c^1 &amp;= r sin(\theta) sin(\phi)\\ \xi^2 - x_c^2 &amp;= r cos(\theta) \end{align}
</p>
<p> The shape map distorts the distance \(r\) between the point and the center while leaving the angles \(\theta\), \(\phi\) between them preserved by applying a spherical harmonic expansion with time-dependent coefficients \(\lambda_{lm}(t)\). There are two ways to specify the time-dependent coefficients \(\lambda_{lm}(t)\):</p>
<ol type="1">
<li>A single FunctionOfTime which specifies all coefficients. This FunctionOfTime should have <code><a class="el" href="classylm_1_1Spherepack.html#a2ebd4a37da65427a2748592e92b5f087">ylm::Spherepack::spectral_size()</a></code> number of components. These are in Spherepack order and should be the Spherepack coefficients, <em>not</em> the spherical harmonic coefficients. See the note below. To use this, set the <code>size_function_of_time_name</code> argument of the constructor to <code>std::nullopt</code>.</li>
<li>Two different FunctionOfTimes. The first is similar to 1.) in that it should have the same number of components, be in Spherepack order, and be the Spherepack coefficients. The only difference is that the \(l = 0\) coefficient should be identically 0. The second FunctionOfTime should have a single component which will be the \(l = 0\) coefficient. This component should be stored as the spherical harmonic coefficient and <em>not</em> a Spherepack coefficient. See the note below. To use this method, set the <code>size_function_of_time_name</code> argument of the constructor to the name of the FunctionOfTime that's in the cache. This method is useful if we have control systems because we have a separate control system controlling a separate function of time for the \(l = 0\) coefficient than we do for the other coefficients.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The quantities stored in the "shape" FunctionOfTime (the <code>shape_function_of_time_name</code> argument in the constructor that must always be specified) are <em><b>not</b></em> the complex spherical-harmonic coefficients \(\lambda_{lm}(t)\), but instead are the real-valued SPHEREPACK coefficients \(a_{lm}(t)\) and \(b_{lm}(t)\) used by Spherepack. This is the same for both methods of specifying FunctionOfTimes above. The relationship between these two sets of coefficients is <p class="formulaDsp">
\begin{align} a_{l0} &amp; = \sqrt{\frac{2}{\pi}}\lambda_{l0}&amp;\qquad l\geq 0,\\ a_{lm} &amp; = (-1)^m\sqrt{\frac{2}{\pi}} \mathrm{Re}(\lambda_{lm}) &amp;\qquad l\geq 1, m\geq 1, \\ b_{lm} &amp; = (-1)^m\sqrt{\frac{2}{\pi}} \mathrm{Im}(\lambda_{lm}) &amp;\qquad l\geq 1, m\geq 1. \end{align}
</p>
 The "shape" FunctionOfTime stores coefficients only for non-negative \(m\); this is because the function we are expanding is real, so the coefficients for \(m&lt;0\) can be obtained from \(m&gt;0\) coefficients by complex conjugation. If the <code>size_function_of_time_name</code> argument is given to the constructor, then it is asserted that the \(l=0\) coefficient of the "shape" function of time is exactly 0. The \(l=0\) coefficient is then controlled by the "size" FunctionOfTime. Unlike the "shape" FunctionOfTime, the quantity in the "size" FunctionOfTime <em><b>is</b></em> the "complex" spherical harmonic coefficient \(\lambda_{00}(t)\), and not the SPHEREPACK coefficient \(a_{00}(t)\) ("complex" is in quotes because all \(m=0\) coefficients are always real.) Here and below we write the equations in terms of \(\lambda_{lm}(t)\) instead of \(a_{lm}(t)\) and \(b_{lm}(t)\), regardless of which FunctionOfTime representation we are using, because the resulting expressions are much shorter.</dd></dl>
<p>An additional domain-dependent transition function \(f(r, \theta, \phi)\) ensures that the distortion falls off correctly to zero at the boundary of the domain.</p>
<h3><a class="anchor" id="autotoc_md283"></a>
Mapped coordinates</h3>
<p >The shape map maps the unmapped coordinates \(\xi^i\) to coordinates \(x^i\):</p>
<p class="formulaDsp">
\begin{equation} x^i = \xi^i - (\xi^i - x_c^i) f(r, \theta, \phi) \sum_{lm} \lambda_{lm}(t)Y_{lm}(\theta, \phi). \end{equation}
</p>
<h3><a class="anchor" id="autotoc_md284"></a>
Inverse map</h3>
<p >The inverse map is given by: </p><p class="formulaDsp">
\begin{equation} \xi^i = x_c^i + (x^i-x_c^i)*(r/\tilde{r}), \end{equation}
</p>
<p> where \(\tilde{r}\) is the radius of \(\xi\), calculated by the transition map. For more details, see ShapeMapTransitionFunction::original_radius_over_radius .</p>
<h3><a class="anchor" id="autotoc_md285"></a>
Frame velocity</h3>
<p >The frame velocity \(v^i\ = dx^i / dt\) is calculated trivially: </p><p class="formulaDsp">
\begin{equation} v^i = - (\xi^i - x_c^i) f(r, \theta, \phi) \sum_{lm} \dot{\lambda}_{lm}(t)Y_{lm}(\theta, \phi). \end{equation}
</p>
<h3><a class="anchor" id="autotoc_md286"></a>
Jacobian</h3>
<p >The Jacobian is given by: </p><p class="formulaDsp">
\begin{equation} \frac{\partial}{\partial \xi^j} x^i = \delta_j^i \left( 1 - f(r, \theta, \phi) \sum_{lm} \lambda_{lm}(t)Y_{lm}(\theta, \phi)\right) + (\xi^i - x_c^i) \left(\frac{\partial}{\partial \xi^j} f(r, \theta, \phi) \sum_{lm} \lambda_{lm}(t)Y_{lm}(\theta, \phi) + f(r, \theta, \phi) \sum_{lm} \lambda_{lm}(t) \frac{\partial}{\partial \xi^j} Y_{lm}(\theta, \phi) \right). \end{equation}
</p>
<h3><a class="anchor" id="autotoc_md287"></a>
Inverse Jacobian</h3>
<p >The inverse Jacobian is computed by numerically inverting the Jacobian.</p>
<p >For future optimization, the <code>interpolation_info</code> objects calculated in all functions of this class could be cached. Since every element should evaluate the same grid coordinates most time steps, this might greatly decrease computation. Every element has their own clone of the shape map so the caching could be done with member variables. Care must be taken that <code>jacobian</code> currently calculates the <code>interpolation_info</code> with an order higher. </p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Domain/CoordinateMaps/TimeDependent/Shape.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedomain.html">domain</a></li><li class="navelem"><a class="el" href="namespacedomain_1_1CoordinateMaps.html">CoordinateMaps</a></li><li class="navelem"><a class="el" href="namespacedomain_1_1CoordinateMaps_1_1TimeDependent.html">TimeDependent</a></li><li class="navelem"><a class="el" href="classdomain_1_1CoordinateMaps_1_1TimeDependent_1_1Shape.html">Shape</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
