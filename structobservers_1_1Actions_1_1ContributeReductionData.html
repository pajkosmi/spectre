<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: observers::Actions::ContributeReductionData Struct Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structobservers_1_1Actions_1_1ContributeReductionData.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="structobservers_1_1Actions_1_1ContributeReductionData-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">observers::Actions::ContributeReductionData Struct Reference<div class="ingroups"><a class="el" href="group__ObserversGroup.html">Observers</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Send reduction data to the observer group.  
 <a href="structobservers_1_1Actions_1_1ContributeReductionData.html#details">More...</a></p>

<p><code>#include &lt;ReductionActions.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aadbc5fd6888b1fcf8f61d639497ef425"><td class="memTemplParams" colspan="2"><a id="aadbc5fd6888b1fcf8f61d639497ef425" name="aadbc5fd6888b1fcf8f61d639497ef425"></a>
template&lt;typename ParallelComponent , typename DbTagsList , typename Metavariables , typename ArrayIndex , typename... Ts, typename Formatter  = observers::NoFormatter&gt; </td></tr>
<tr class="memitem:aadbc5fd6888b1fcf8f61d639497ef425"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>apply</b> (db::DataBox&lt; DbTagsList &gt; &amp;box, <a class="el" href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache</a>&lt; Metavariables &gt; &amp;cache, const ArrayIndex &amp;array_index, const <a class="el" href="classobservers_1_1ObservationId.html">observers::ObservationId</a> &amp;observation_id, const <a class="el" href="classobservers_1_1ArrayComponentId.html">ArrayComponentId</a> &amp;sender_array_id, const <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> &amp;subfile_name, const <a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> &gt; &amp;reduction_names, Parallel::ReductionData&lt; Ts... &gt; &amp;&amp;reduction_data, <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt; Formatter &gt; &amp;&amp;formatter=std::nullopt, const bool observe_per_core=false)</td></tr>
<tr class="separator:aadbc5fd6888b1fcf8f61d639497ef425"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Send reduction data to the observer group. </p>
<p >Once everything at a specific <code><a class="el" href="classobservers_1_1ObservationId.html" title="A unique identifier for an observation representing the type of observation and the instance (e....">ObservationId</a></code> has been contributed to the reduction, the groups reduce to their local nodegroup.</p>
<p >The caller of this Action (which is to be invoked on the <a class="el" href="structobservers_1_1Observer.html" title="The group parallel component that is responsible for reducing data to be observed.">Observer</a> parallel component) must pass in an <code>observation_id</code> used to uniquely identify the observation in time, the name of the <code><a class="el" href="classh5_1_1Dat.html" title="Represents a multicolumn dat file inside an HDF5 file.">h5::Dat</a></code> subfile in the HDF5 file (e.g. <code>/element_data</code>, where the slash is important), a <code><a class="elRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a>&lt;<a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&gt;</code> of names of the quantities being reduced (e.g. <code>{"Time", "L1ErrorDensity", "L2ErrorDensity"}</code>), and the <code>Parallel::ReductionData</code> that holds the <code>ReductionDatums</code> containing info on how to do the reduction.</p>
<p >The observer components need to know all expected reduction data types by compile-time, so they rely on the <code>Metavariables::observed_reduction_data_tags</code> alias to collect them in one place. To this end, each Action that contributes reduction data must expose the type alias as:</p>
<div class="fragment"><div class="line">  <span class="keyword">using</span> observed_reduction_data_tags = observers::make_reduction_data_tags&lt;</div>
<div class="line">      tmpl::list&lt;reduction_data_from_doubles, reduction_data_from_vector,</div>
<div class="line">                 reduction_data_from_ds_and_vs&gt;&gt;;</div>
</div><!-- fragment --><p >Then, in the <code>Metavariables</code> collect them from all observing <a class="el" href="namespaceobservers_1_1Actions.html" title="Actions used by the observer parallel component">Actions</a> using the <code>observers::collect_reduction_data_tags</code> metafunction.</p>
<p >This action also accepts a "formatter" that will be forwarded along with the reduction data and used to print an informative message when the reduction is complete. The formatter must conform to <code><a class="el" href="structobservers_1_1protocols_1_1ReductionDataFormatter.html" title="Conforming classes can create an informative message from reduction data. The message will be printed...">observers::protocols::ReductionDataFormatter</a></code>.</p>
<p >This action also supports observing the intermediate stage of the reduction over just the processing element that the element is currently on. This can be useful e.g. to measure performance metric to assess load-balancing such as the number of grid points on each core. Enable per-core observations by passing <code>true</code> for the <code>observe_per_core</code> argument (default: <code>false</code>). The data will be written in one H5 file per <em>node</em> prefixed with the <code><a class="el" href="structobservers_1_1Tags_1_1ReductionFileName.html" title="The name of the HDF5 file on disk into which reduction data is written.">observers::Tags::ReductionFileName</a></code>, in a <code>Core{core_id}</code> subfile, where <code>core_id</code> is an integer identifying the core across all nodes (see <code><a class="el" href="group__ParallelGroup.html#gadf89c583112f5be12c618a0ec2fc0cfb" title="Index of my processing element.">Parallel::my_proc</a></code>). For example, when running on 2 nodes with 2 cores each you will end up with <code>Reductions0.h5</code> containing <code>/Core0/{subfile_name}.dat</code> and <code>/Core1/{subfile_name}.dat</code>, and <code>Reductions1.h5</code> containing <code>/Core2/{subfile_name}.dat</code> and <code>/Core3/{subfile_name}.dat</code>. This is in addition to the usual reduction output over <em>all</em> registered elements, written to <code>Reductions.h5</code> (no node ID suffix in the file name). </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/IO/Observer/ReductionActions.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>observers</b></li><li class="navelem"><a class="el" href="namespaceobservers_1_1Actions.html">Actions</a></li><li class="navelem"><a class="el" href="structobservers_1_1Actions_1_1ContributeReductionData.html">ContributeReductionData</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
