<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: RelativisticEuler::Solutions::TovSolution Class Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classRelativisticEuler_1_1Solutions_1_1TovSolution.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classRelativisticEuler_1_1Solutions_1_1TovSolution-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">RelativisticEuler::Solutions::TovSolution Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>TOV solver based on Lindblom's method.  
 <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#details">More...</a></p>

<p><code>#include &lt;Tov.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac25d79fc9e06fc21931122eee353ab42"><td class="memItemLeft" align="right" valign="top"><a id="ac25d79fc9e06fc21931122eee353ab42" name="ac25d79fc9e06fc21931122eee353ab42"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>TovSolution</b> (const <a class="el" href="classEquationsOfState_1_1EquationOfState.html">EquationsOfState::EquationOfState</a>&lt; true, 1 &gt; &amp;equation_of_state, double central_mass_density, const <a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796">TovCoordinates</a> <a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935">coordinate_system</a>=<a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796a87f784c5f4c9fd378dccf4b36ec1689e">TovCoordinates::Schwarzschild</a>, double log_enthalpy_at_outer_radius=0.0, double absolute_tolerance=1.e-18, double relative_tolerance=1.0e-14)</td></tr>
<tr class="separator:ac25d79fc9e06fc21931122eee353ab42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523a27078e4e5e21468cd2d910aa55a6"><td class="memItemLeft" align="right" valign="top"><a id="a523a27078e4e5e21468cd2d910aa55a6" name="a523a27078e4e5e21468cd2d910aa55a6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>TovSolution</b> (const <a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;)=default</td></tr>
<tr class="separator:a523a27078e4e5e21468cd2d910aa55a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e1c5a57b70444d041c1cf7fce55d65"><td class="memItemLeft" align="right" valign="top"><a id="a80e1c5a57b70444d041c1cf7fce55d65" name="a80e1c5a57b70444d041c1cf7fce55d65"></a>
<a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;)=default</td></tr>
<tr class="separator:a80e1c5a57b70444d041c1cf7fce55d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd530afb043dbf0b3e002f1bff2d353"><td class="memItemLeft" align="right" valign="top"><a id="a7dd530afb043dbf0b3e002f1bff2d353" name="a7dd530afb043dbf0b3e002f1bff2d353"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>TovSolution</b> (<a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a7dd530afb043dbf0b3e002f1bff2d353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeef2b19a9e45866c2d419312919a1f5"><td class="memItemLeft" align="right" valign="top"><a id="aeeef2b19a9e45866c2d419312919a1f5" name="aeeef2b19a9e45866c2d419312919a1f5"></a>
<a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a> &amp;&amp;)=default</td></tr>
<tr class="separator:aeeef2b19a9e45866c2d419312919a1f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a37c3a62eb60f2be1fdbe1ba0e7935"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796">TovCoordinates</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935">coordinate_system</a> () const</td></tr>
<tr class="memdesc:a15a37c3a62eb60f2be1fdbe1ba0e7935"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of radial coordinate.  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935">More...</a><br /></td></tr>
<tr class="separator:a15a37c3a62eb60f2be1fdbe1ba0e7935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b1b8536cc148c568e7059c0b460f53"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#ad4b1b8536cc148c568e7059c0b460f53">outer_radius</a> () const</td></tr>
<tr class="memdesc:ad4b1b8536cc148c568e7059c0b460f53"><td class="mdescLeft">&#160;</td><td class="mdescRight">The outer radius of the solution.  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#ad4b1b8536cc148c568e7059c0b460f53">More...</a><br /></td></tr>
<tr class="separator:ad4b1b8536cc148c568e7059c0b460f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac65603a72a1c69ce1dfbad4b85fff8c"><td class="memItemLeft" align="right" valign="top"><a id="aac65603a72a1c69ce1dfbad4b85fff8c" name="aac65603a72a1c69ce1dfbad4b85fff8c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>total_mass</b> () const</td></tr>
<tr class="memdesc:aac65603a72a1c69ce1dfbad4b85fff8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The total mass \(m(R)\), where \(R\) is the outer radius. <br /></td></tr>
<tr class="separator:aac65603a72a1c69ce1dfbad4b85fff8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03983618f77d0fcbb22cddaad13ca845"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a03983618f77d0fcbb22cddaad13ca845">injection_energy</a> () const</td></tr>
<tr class="memdesc:a03983618f77d0fcbb22cddaad13ca845"><td class="mdescLeft">&#160;</td><td class="mdescRight">The injection energy \(\mathcal{E}=\alpha(r=R)=\sqrt{1-2M/R}\).  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a03983618f77d0fcbb22cddaad13ca845">More...</a><br /></td></tr>
<tr class="separator:a03983618f77d0fcbb22cddaad13ca845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc5a33328dedf2d5ef6a5d8ebba81e4"><td class="memTemplParams" colspan="2">template&lt;typename DataType &gt; </td></tr>
<tr class="memitem:a2fc5a33328dedf2d5ef6a5d8ebba81e4"><td class="memTemplItemLeft" align="right" valign="top">DataType&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a2fc5a33328dedf2d5ef6a5d8ebba81e4">mass_over_radius</a> (const DataType &amp;r) const</td></tr>
<tr class="memdesc:a2fc5a33328dedf2d5ef6a5d8ebba81e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The mass inside the given radius over the areal radius, \(\frac{m(r)}{r}\).  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a2fc5a33328dedf2d5ef6a5d8ebba81e4">More...</a><br /></td></tr>
<tr class="separator:a2fc5a33328dedf2d5ef6a5d8ebba81e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0939f95b94d5f1995175ede7a5d9076d"><td class="memTemplParams" colspan="2">template&lt;typename DataType &gt; </td></tr>
<tr class="memitem:a0939f95b94d5f1995175ede7a5d9076d"><td class="memTemplItemLeft" align="right" valign="top">DataType&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a0939f95b94d5f1995175ede7a5d9076d">log_specific_enthalpy</a> (const DataType &amp;r) const</td></tr>
<tr class="memdesc:a0939f95b94d5f1995175ede7a5d9076d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The log of the specific enthalpy at the given radius.  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a0939f95b94d5f1995175ede7a5d9076d">More...</a><br /></td></tr>
<tr class="separator:a0939f95b94d5f1995175ede7a5d9076d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd274e680f85c27afecba7b08493ea5"><td class="memTemplParams" colspan="2">template&lt;typename DataType &gt; </td></tr>
<tr class="memitem:a6bd274e680f85c27afecba7b08493ea5"><td class="memTemplItemLeft" align="right" valign="top">DataType&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a6bd274e680f85c27afecba7b08493ea5">conformal_factor</a> (const DataType &amp;r) const</td></tr>
<tr class="memdesc:a6bd274e680f85c27afecba7b08493ea5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The conformal factor \(\psi=\sqrt{r / \bar{r}}\).  <a href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a6bd274e680f85c27afecba7b08493ea5">More...</a><br /></td></tr>
<tr class="separator:a6bd274e680f85c27afecba7b08493ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0028fbaf86431c0784a9224578974c3b"><td class="memItemLeft" align="right" valign="top"><a id="a0028fbaf86431c0784a9224578974c3b" name="a0028fbaf86431c0784a9224578974c3b"></a>
const <a class="el" href="classintrp_1_1CubicSpline.html">intrp::CubicSpline</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>mass_over_radius_interpolant</b> () const</td></tr>
<tr class="separator:a0028fbaf86431c0784a9224578974c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189222f09181989c7d4848e523499a65"><td class="memItemLeft" align="right" valign="top"><a id="a189222f09181989c7d4848e523499a65" name="a189222f09181989c7d4848e523499a65"></a>
const <a class="el" href="classintrp_1_1CubicSpline.html">intrp::CubicSpline</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>log_specific_enthalpy_interpolant</b> () const</td></tr>
<tr class="separator:a189222f09181989c7d4848e523499a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245c352cb315c7d761c699e698402a38"><td class="memItemLeft" align="right" valign="top"><a id="a245c352cb315c7d761c699e698402a38" name="a245c352cb315c7d761c699e698402a38"></a>
const <a class="el" href="classintrp_1_1CubicSpline.html">intrp::CubicSpline</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>conformal_factor_interpolant</b> () const</td></tr>
<tr class="separator:a245c352cb315c7d761c699e698402a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ecace645d3dde30e636c42e9b3c434f"><td class="memItemLeft" align="right" valign="top"><a id="a8ecace645d3dde30e636c42e9b3c434f" name="a8ecace645d3dde30e636c42e9b3c434f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pup</b> (PUP::er &amp;p)</td></tr>
<tr class="separator:a8ecace645d3dde30e636c42e9b3c434f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >TOV solver based on Lindblom's method. </p>
<p >Uses Lindblom's method of integrating the TOV equations from <a class="el" href="citelist.html#CITEREF_Lindblom1998dp">[108]</a> .</p>
<p >Instead of integrating the interior mass \(m(r)\) and pressure \(p(r)\), Lindblom introduces the variables \(u=r^2\) and \(v=m/r\). Then, the TOV equations are integrated with the log of the specific enthalpy as the independent variable, \(\ln(h)\), from the center of the star where \(h(r=0) = h_c\) to its surface \(h(r=R) = 1\). The ODEs being solved are Eq. (A2) and (A3) in <a class="el" href="citelist.html#CITEREF_Lindblom1998dp">[108]</a> :</p>
<p class="formulaDsp">
\begin{align} \frac{\mathrm{d}u}{\mathrm{d}\ln{h}} &amp;= \frac{-2u (1 - 2v)}{4\pi u p + v} \\ \frac{\mathrm{d}v}{\mathrm{d}\ln{h}} &amp;= -(1 - 2v) \frac{4\pi u \rho - v}{4\pi u p + v} \end{align}
</p>
<p >Note that Lindblom's paper labels the independent variable as \(h\). However the \(h\) in Lindblom's paper is <b>not</b> the specific enthalpy but its logarithm, \(\ln(h)\).</p>
<p >The ODEs are solved numerically when this class is constructed, and the quantities \(m(r)/r\) and \(\ln(h)\) are interpolated and exposed as member functions. With these quantities the metric can be constructed as:</p>
<p class="formulaDsp">
\begin{equation} \mathrm{d}s^2 = -\alpha^2 \mathrm{d}t^2 + (1 - 2m/r)^{-1} \mathrm{d}r^2 + r^2 \mathrm{d}\Omega^2 \end{equation}
</p>
<p >where the lapse is</p>
<p class="formulaDsp">
\begin{equation} \alpha(r &lt; R) = \mathcal{E} / h = \alpha(r=R) / h \text{,} \end{equation}
</p>
<p >with the conserved <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a03983618f77d0fcbb22cddaad13ca845" title="The injection energy .">injection_energy()</a></code> \(\mathcal{E}\), such that the lapse matches the exterior Schwarzschild solution:</p>
<p class="formulaDsp">
\begin{equation} \alpha(r \geq R) = \sqrt{1 - \frac{2M}{r}} \end{equation}
</p>
<dl class="section user"><dt>Isotropic radial coordinate</dt><dd>This class also supports transforming to an isotropic radial coordinate. When you pass <code><a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796a14b5edf8fb82e568afeb4413c67fa479" title="Isotropic radial coordinate, in which the spatial metric is conformally flat.">RelativisticEuler::Solutions::TovCoordinates::Isotropic</a></code> to the constructor, an additional ODE is integrated alongside the TOV equations to determine the conformal factor</dd></dl>
<p class="formulaDsp">
\begin{equation} \psi^2 = \frac{r}{\bar{r}} \end{equation}
</p>
<p >where \(r\) is the areal (Schwarzschild) radius and \(\bar{r}\) is the isotropic radius. The additional ODE is:</p>
<p class="formulaDsp">
\begin{equation} \frac{\mathrm{d}\ln(\psi)}{\mathrm{d}\ln{h}} = \frac{\sqrt{1 - 2v}}{1 + \sqrt{1 - 2v}} \frac{v}{4\pi u p + v} \end{equation}
</p>
<p >In isotropic coordinates, the spatial metric is conformally flat:</p>
<p class="formulaDsp">
\begin{equation} \mathrm{d}s^2 = -\alpha^2 \mathrm{d}t^2 + \psi^4 (\mathrm{d}\bar{r}^2 + \bar{r}^2 \mathrm{d}\Omega^2) \end{equation}
</p>
<p >When isotropic coordinates are selected, radii returned by member functions or taken as arguments are isotropic. An exception is <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a2fc5a33328dedf2d5ef6a5d8ebba81e4" title="The mass inside the given radius over the areal radius, .">mass_over_radius()</a></code>, which always returns the quantity \(m / r\) because that is the quantity stored internally and hence most numerically precise. See <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a2fc5a33328dedf2d5ef6a5d8ebba81e4" title="The mass inside the given radius over the areal radius, .">mass_over_radius()</a></code> for details. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6bd274e680f85c27afecba7b08493ea5" name="a6bd274e680f85c27afecba7b08493ea5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd274e680f85c27afecba7b08493ea5">&#9670;&nbsp;</a></span>conformal_factor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">DataType RelativisticEuler::Solutions::TovSolution::conformal_factor </td>
          <td>(</td>
          <td class="paramtype">const DataType &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The conformal factor \(\psi=\sqrt{r / \bar{r}}\). </p>
<p >The conformal factor is computed only when the <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935" title="The type of radial coordinate.">coordinate_system()</a></code> is <code>RelativisticEuler::Solution::TovCoordinates::Isotropic</code>. Otherwise, it is an error to call this function.</p>
<dl class="section note"><dt>Note</dt><dd><code>r</code> should be non-negative and not greater than <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#ad4b1b8536cc148c568e7059c0b460f53" title="The outer radius of the solution.">outer_radius()</a></code> </dd></dl>

</div>
</div>
<a id="a15a37c3a62eb60f2be1fdbe1ba0e7935" name="a15a37c3a62eb60f2be1fdbe1ba0e7935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15a37c3a62eb60f2be1fdbe1ba0e7935">&#9670;&nbsp;</a></span>coordinate_system()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796">TovCoordinates</a> RelativisticEuler::Solutions::TovSolution::coordinate_system </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The type of radial coordinate. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespaceRelativisticEuler_1_1Solutions.html#a3f28dbca2da7a57e573f9e641776a796" title="Radial coordinate of a TOV solution.">RelativisticEuler::Solutions::TovCoordinates</a> </dd></dl>

</div>
</div>
<a id="a03983618f77d0fcbb22cddaad13ca845" name="a03983618f77d0fcbb22cddaad13ca845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03983618f77d0fcbb22cddaad13ca845">&#9670;&nbsp;</a></span>injection_energy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RelativisticEuler::Solutions::TovSolution::injection_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The injection energy \(\mathcal{E}=\alpha(r=R)=\sqrt{1-2M/R}\). </p>
<p >The injection energy of the TOV solution is</p>
<p class="formulaDsp">
\begin{equation} \mathcal{E} = -h k^a u_a = h \alpha \text{,} \end{equation}
</p>
<p >where \(\boldsymbol{k} = \partial_t\) is a Killing vector of the static solution, \(h\) is the specific enthalpy, \(u_a\) is the fluid four-velocity, and \(\alpha\) is the lapse (see, e.g., Eqs. (2.19) and (4.2) in <a class="el" href="citelist.html#CITEREF_Moldenhauer2014yaa">[118]</a>). Since the TOV solution is static, the injection energy is conserved not only along stream lines but throughout the star,</p>
<p class="formulaDsp">
\begin{equation} \nabla_a \mathcal{E} = 0 \text{.} \end{equation}
</p>
<p >Therefore,</p>
<p class="formulaDsp">
\begin{equation} \mathcal{E} = \alpha(r=R) = \sqrt{1 - 2M/R} \end{equation}
</p>
<p >by evaluating the injection energy at the outer (areal) radius \(R\), where \(h=1\) and where we match the lapse to the outer Schwarzschild solution. The conservation also implies</p>
<p class="formulaDsp">
\begin{equation} \alpha = \mathcal{E} / h \end{equation}
</p>
<p >throughout the star. </p>

</div>
</div>
<a id="a0939f95b94d5f1995175ede7a5d9076d" name="a0939f95b94d5f1995175ede7a5d9076d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0939f95b94d5f1995175ede7a5d9076d">&#9670;&nbsp;</a></span>log_specific_enthalpy()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">DataType RelativisticEuler::Solutions::TovSolution::log_specific_enthalpy </td>
          <td>(</td>
          <td class="paramtype">const DataType &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The log of the specific enthalpy at the given radius. </p>
<dl class="section note"><dt>Note</dt><dd><code>r</code> should be non-negative and not greater than <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#ad4b1b8536cc148c568e7059c0b460f53" title="The outer radius of the solution.">outer_radius()</a></code> </dd></dl>

</div>
</div>
<a id="a2fc5a33328dedf2d5ef6a5d8ebba81e4" name="a2fc5a33328dedf2d5ef6a5d8ebba81e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fc5a33328dedf2d5ef6a5d8ebba81e4">&#9670;&nbsp;</a></span>mass_over_radius()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DataType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">DataType RelativisticEuler::Solutions::TovSolution::mass_over_radius </td>
          <td>(</td>
          <td class="paramtype">const DataType &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The mass inside the given radius over the areal radius, \(\frac{m(r)}{r}\). </p>
<p >The argument to this function is the radius in the <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935" title="The type of radial coordinate.">coordinate_system()</a></code>, i.e., areal (Schwarzschild) or isotropic radius. The denominator \(r\) in the return value is always the areal (Schwarzschild) radius. You can use the conformal factor \(\psi=\sqrt{r / \bar{r}}\) returned by the <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a6bd274e680f85c27afecba7b08493ea5" title="The conformal factor .">conformal_factor()</a></code> function to obtain the mass over the isotropic radius, or the mass alone. The reason for this choice is that we represent the solution internally as the mass over the areal radius, so this is the most numerically precise quantity from which other quantities can be derived.</p>
<dl class="section note"><dt>Note</dt><dd><code>r</code> should be non-negative and not greater than <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#ad4b1b8536cc148c568e7059c0b460f53" title="The outer radius of the solution.">outer_radius()</a></code>. </dd></dl>

</div>
</div>
<a id="ad4b1b8536cc148c568e7059c0b460f53" name="ad4b1b8536cc148c568e7059c0b460f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b1b8536cc148c568e7059c0b460f53">&#9670;&nbsp;</a></span>outer_radius()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RelativisticEuler::Solutions::TovSolution::outer_radius </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The outer radius of the solution. </p>
<p >This is the outer radius in the specified <code><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html#a15a37c3a62eb60f2be1fdbe1ba0e7935" title="The type of radial coordinate.">coordinate_system()</a></code>, i.e., areal or isotropic.</p>
<dl class="section note"><dt>Note</dt><dd>This is the radius at which <code>log_specific_enthalpy</code> is equal to the value of <code>log_enthalpy_at_outer_radius</code> that was given when constructing this <a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html" title="TOV solver based on Lindblom&#39;s method.">TovSolution</a> </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/PointwiseFunctions/AnalyticSolutions/RelativisticEuler/Tov.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceRelativisticEuler.html">RelativisticEuler</a></li><li class="navelem"><a class="el" href="namespaceRelativisticEuler_1_1Solutions.html">Solutions</a></li><li class="navelem"><a class="el" href="classRelativisticEuler_1_1Solutions_1_1TovSolution.html">TovSolution</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
