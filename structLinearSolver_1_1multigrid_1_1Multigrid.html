<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: LinearSolver::multigrid::Multigrid&lt; Dim, FieldsTag, OptionsGroup, ResidualIsMassiveTag, SourceTag &gt; Struct Template Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structLinearSolver_1_1multigrid_1_1Multigrid.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="structLinearSolver_1_1multigrid_1_1Multigrid-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">LinearSolver::multigrid::Multigrid&lt; Dim, FieldsTag, OptionsGroup, ResidualIsMassiveTag, SourceTag &gt; Struct Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A V-cycle geometric multgrid solver for linear equations \(Ax = b\).  
 <a href="structLinearSolver_1_1multigrid_1_1Multigrid.html#details">More...</a></p>

<p><code>#include &lt;Multigrid.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:afe53e4cb0e44f2ab6230e4502cb6c941"><td class="memItemLeft" align="right" valign="top"><a id="afe53e4cb0e44f2ab6230e4502cb6c941" name="afe53e4cb0e44f2ab6230e4502cb6c941"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>fields_tag</b> = FieldsTag</td></tr>
<tr class="separator:afe53e4cb0e44f2ab6230e4502cb6c941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f85701e868a9d81a0ad0b765d6f476"><td class="memItemLeft" align="right" valign="top"><a id="a37f85701e868a9d81a0ad0b765d6f476" name="a37f85701e868a9d81a0ad0b765d6f476"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>options_group</b> = OptionsGroup</td></tr>
<tr class="separator:a37f85701e868a9d81a0ad0b765d6f476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2318ac602bf3d4b0f8436214253726a7"><td class="memItemLeft" align="right" valign="top"><a id="a2318ac602bf3d4b0f8436214253726a7" name="a2318ac602bf3d4b0f8436214253726a7"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>source_tag</b> = SourceTag</td></tr>
<tr class="separator:a2318ac602bf3d4b0f8436214253726a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939ff9cfde0d76d900f9ec282f1e8e2f"><td class="memItemLeft" align="right" valign="top"><a id="a939ff9cfde0d76d900f9ec282f1e8e2f" name="a939ff9cfde0d76d900f9ec282f1e8e2f"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>operand_tag</b> = FieldsTag</td></tr>
<tr class="separator:a939ff9cfde0d76d900f9ec282f1e8e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b984a363da8d8ad2e192fb5c36cce95"><td class="memItemLeft" align="right" valign="top"><a id="a6b984a363da8d8ad2e192fb5c36cce95" name="a6b984a363da8d8ad2e192fb5c36cce95"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>smooth_source_tag</b> = source_tag</td></tr>
<tr class="separator:a6b984a363da8d8ad2e192fb5c36cce95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51064dbc29b2b30706775373bf81a8b2"><td class="memItemLeft" align="right" valign="top"><a id="a51064dbc29b2b30706775373bf81a8b2" name="a51064dbc29b2b30706775373bf81a8b2"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>smooth_fields_tag</b> = fields_tag</td></tr>
<tr class="separator:a51064dbc29b2b30706775373bf81a8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d761f4fbc7b6b7784786a67fd115fa3"><td class="memItemLeft" align="right" valign="top"><a id="a4d761f4fbc7b6b7784786a67fd115fa3" name="a4d761f4fbc7b6b7784786a67fd115fa3"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>component_list</b> = tmpl::list&lt;&gt;</td></tr>
<tr class="separator:a4d761f4fbc7b6b7784786a67fd115fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ade5fc5cf743bc1b5935a5bc2bb7e7"><td class="memItemLeft" align="right" valign="top"><a id="a04ade5fc5cf743bc1b5935a5bc2bb7e7" name="a04ade5fc5cf743bc1b5935a5bc2bb7e7"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>observed_reduction_data_tags</b> = observers::make_reduction_data_tags&lt; tmpl::list&lt; async_solvers::reduction_data &gt; &gt;</td></tr>
<tr class="separator:a04ade5fc5cf743bc1b5935a5bc2bb7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889b8061f0d6ccff477eb93446ca0f4f"><td class="memItemLeft" align="right" valign="top"><a id="a889b8061f0d6ccff477eb93446ca0f4f" name="a889b8061f0d6ccff477eb93446ca0f4f"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>initialize_element</b> = tmpl::list&lt; <a class="el" href="structLinearSolver_1_1async__solvers_1_1InitializeElement.html">async_solvers::InitializeElement</a>&lt; FieldsTag, OptionsGroup, SourceTag &gt;, detail::InitializeElement&lt; Dim, FieldsTag, OptionsGroup, SourceTag &gt; &gt;</td></tr>
<tr class="separator:a889b8061f0d6ccff477eb93446ca0f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43cad648dd0fe9d6a34aba50b99c2c28"><td class="memItemLeft" align="right" valign="top"><a id="a43cad648dd0fe9d6a34aba50b99c2c28" name="a43cad648dd0fe9d6a34aba50b99c2c28"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>register_element</b> = tmpl::list&lt; <a class="el" href="structobservers_1_1Actions_1_1RegisterWithObservers.html">async_solvers::RegisterElement</a>&lt; FieldsTag, OptionsGroup, SourceTag, <a class="el" href="structLinearSolver_1_1multigrid_1_1Tags_1_1IsFinestGrid.html">Tags::IsFinestGrid</a> &gt;, <a class="el" href="structobservers_1_1Actions_1_1RegisterWithObservers.html">observers::Actions::RegisterWithObservers</a>&lt; detail::RegisterWithVolumeObserver&lt; OptionsGroup &gt; &gt; &gt;</td></tr>
<tr class="separator:a43cad648dd0fe9d6a34aba50b99c2c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5e67500c0e871db0edd15743b32575"><td class="memTemplParams" colspan="2"><a id="a3e5e67500c0e871db0edd15743b32575" name="a3e5e67500c0e871db0edd15743b32575"></a>
template&lt;typename ApplyOperatorActions , typename PreSmootherActions , typename PostSmootherActions , typename Label  = OptionsGroup&gt; </td></tr>
<tr class="memitem:a3e5e67500c0e871db0edd15743b32575"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><b>solve</b> = tmpl::list&lt; <a class="el" href="structLinearSolver_1_1async__solvers_1_1PrepareSolve.html">async_solvers::PrepareSolve</a>&lt; FieldsTag, OptionsGroup, SourceTag, Label, <a class="el" href="structLinearSolver_1_1multigrid_1_1Tags_1_1IsFinestGrid.html">Tags::IsFinestGrid</a>, false &gt;, <a class="el" href="structLinearSolver_1_1multigrid_1_1Actions_1_1ReceiveFieldsFromFinerGrid.html">detail::ReceiveResidualFromFinerGrid</a>&lt; Dim, FieldsTag, OptionsGroup, SourceTag &gt;, detail::PreparePreSmoothing&lt; FieldsTag, OptionsGroup, SourceTag &gt;, PreSmootherActions, detail::SkipPostSmoothingAtBottom&lt; FieldsTag, OptionsGroup, SourceTag &gt;, <a class="el" href="structLinearSolver_1_1multigrid_1_1Actions_1_1SendFieldsToCoarserGrid.html">detail::SendResidualToCoarserGrid</a>&lt; FieldsTag, OptionsGroup, ResidualIsMassiveTag, SourceTag &gt;, detail::ReceiveCorrectionFromCoarserGrid&lt; Dim, FieldsTag, OptionsGroup, SourceTag &gt;, ApplyOperatorActions, <a class="el" href="structActions_1_1Label.html">::Actions::Label</a>&lt; detail::PostSmoothingBeginLabel &gt;, PostSmootherActions, detail::SendCorrectionToFinerGrid&lt; FieldsTag, OptionsGroup, SourceTag &gt;, detail::ObserveVolumeData&lt; FieldsTag, OptionsGroup, SourceTag &gt;, <a class="el" href="structLinearSolver_1_1async__solvers_1_1CompleteStep.html">async_solvers::CompleteStep</a>&lt; FieldsTag, OptionsGroup, SourceTag, Label, <a class="el" href="structLinearSolver_1_1multigrid_1_1Tags_1_1IsFinestGrid.html">Tags::IsFinestGrid</a>, false &gt; &gt;</td></tr>
<tr class="separator:a3e5e67500c0e871db0edd15743b32575"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t Dim, typename FieldsTag, typename OptionsGroup, typename ResidualIsMassiveTag, typename SourceTag = db::add_tag_prefix&lt;::Tags::FixedSource, FieldsTag&gt;&gt;<br />
struct LinearSolver::multigrid::Multigrid&lt; Dim, FieldsTag, OptionsGroup, ResidualIsMassiveTag, SourceTag &gt;</div><p >A V-cycle geometric multgrid solver for linear equations \(Ax = b\). </p>
<p >This linear solver iteratively corrects an initial guess \(x_0\) by restricting the residual \(b - Ax\) to a series of coarser grids, solving for a correction on the coarser grids, and then prolongating (interpolating) the correction back to the finer grids. The solves on grids with different scales can very effectively solve large-scale modes in the solution, which Krylov-type linear solvers such as GMRES or Conjugate Gradients typically struggle with. Therefore, a multigrid solver can be an effective preconditioner for Krylov-type linear solvers (see <code><a class="el" href="structLinearSolver_1_1gmres_1_1Gmres.html" title="A GMRES solver for nonsymmetric linear systems of equations .">LinearSolver::gmres::Gmres</a></code> and <code><a class="el" href="structLinearSolver_1_1cg_1_1ConjugateGradient.html" title="A conjugate gradient solver for linear systems of equations  where the operator  is symmetric.">LinearSolver::cg::ConjugateGradient</a></code>). See <a class="el" href="citelist.html#CITEREF_Briggs2000jp">[27]</a> for an introduction to multigrid methods.</p>
<dl class="section user"><dt>Grid hierarchy</dt><dd>This geometric multigrid solver relies on a strategy to coarsen the computational grid in a way that removes small-scale modes. We currently h-coarsen the domain, meaning that we create multigrid levels by successively combining two elements into one along every dimension of the grid. We only p-coarsen the grid in the sense that we choose the smaller of the two polynomial degrees when combining elements. This strategy follows <a class="el" href="citelist.html#CITEREF_Vincent2019qpd">[166]</a>. See <code><a class="el" href="structLinearSolver_1_1multigrid_1_1ElementsAllocator.html" title="A Parallel::protocols::ArrayElementsAllocator that creates array elements to cover the initial comput...">LinearSolver::multigrid::ElementsAllocator</a></code> and <code><a class="el" href="namespaceLinearSolver_1_1multigrid.html#a734e07941bc7e3255393e22401d3f732" title="Coarsen the initial refinement levels of all blocks in the domain.">LinearSolver::multigrid::coarsen</a></code> for the code that creates the multigrid hierarchy.</dd></dl>
<dl class="section user"><dt>Inter-mesh operators</dt><dd>The algorithm relies on operations that project data between grids. Residuals are projected from finer to coarser grids ("restriction") and solutions are projected from coarser to finer grids ("prolongation"). We use the standard \(L_2\)-projections implemented in <code><a class="el" href="namespaceSpectral.html#ae3038f4dbb9d4a31ac0590896b8c92ea" title="The projection matrix from a child mesh to its parent.">Spectral::projection_matrix_child_to_parent</a></code> and <code><a class="el" href="namespaceSpectral.html#a3980ca7e975bd40576a3b8b2f024767e" title="The projection matrix from a parent mesh to one of its children.">Spectral::projection_matrix_parent_to_child</a></code>, where "child" means the finer grid and "parent" means the coarser grid. Note that the residuals \(b - Ax\) may or may not already include a mass matrix and Jacobian factors, depending on the implementation of the linear operator \(A\). To account for this, provide a tag as the <code>ResidualIsMassiveTag</code> that holds a <code>bool</code>. See section 3 in <a class="el" href="citelist.html#CITEREF_Fortunato2019jl">[62]</a> for details on the inter-mesh operators.</dd></dl>
<dl class="section user"><dt>Smoother</dt><dd>On every level of the grid hierarchy the multigrid solver relies on a "smoother" that performs an approximate linear solve on that level. The smoother can be any linear solver that solves the <code>smooth_fields_tag</code> for the source in the <code>smooth_source_tag</code>. Useful smoothers are asynchronous linear solvers that parallelize well, such as <code><a class="el" href="structLinearSolver_1_1Schwarz_1_1Schwarz.html" title="An additive Schwarz subdomain solver for linear systems of equations .">LinearSolver::Schwarz::Schwarz</a></code>. The multigrid algorithm doesn't assume anything about the smoother, but requires only that the <code>PreSmootherActions</code> and the <code>PostSmootherActions</code> passed to <code>solve</code> leave the <code>smooth_fields_tag</code> in a state that represents an approximate solution to the <code>smooth_source_tag</code>, and that <code><a class="el" href="group__DataBoxTagsGroup.html#gafeeced2a7fb41fdced8c55e76343f63c" title="Wrap Tag in Prefix&lt;_, Args...&gt;, unless Tag is a Tags::Variables, in which case this creates a new Tag...">db::add_tag_prefix</a>&lt;<a class="el" href="structLinearSolver_1_1Tags_1_1OperatorAppliedTo.html" title="The linear operator  applied to the data in Tag">LinearSolver::Tags::OperatorAppliedTo</a>, smooth_fields_tag&gt;</code> is left up-to-date as well. The smoother can assume that, on entry, these two tags represent the initial fields and the linear operator applied to the initial fields, respectively. Here's an example of setting up a smoother for the multigrid solver:</dd></dl>
<div class="fragment"><div class="line">  <span class="keyword">using</span> multigrid = <a class="code hl_struct" href="structLinearSolver_1_1multigrid_1_1Multigrid.html">LinearSolver::multigrid::Multigrid</a>&lt;</div>
<div class="line">      volume_dim, helpers_mg::fields_tag, MultigridSolver,</div>
<div class="line">      helpers_mg::OperatorIsMassive, helpers_mg::sources_tag&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> smoother = <a class="code hl_struct" href="structLinearSolver_1_1Richardson_1_1Richardson.html">LinearSolver::Richardson::Richardson</a>&lt;</div>
<div class="line">      <span class="keyword">typename</span> multigrid::smooth_fields_tag, RichardsonSmoother,</div>
<div class="line">      <span class="keyword">typename</span> multigrid::smooth_source_tag,</div>
<div class="line">      <a class="code hl_struct" href="structLinearSolver_1_1multigrid_1_1Tags_1_1MultigridLevel.html">LinearSolver::multigrid::Tags::MultigridLevel</a>&gt;;</div>
<div class="ttc" id="astructLinearSolver_1_1Richardson_1_1Richardson_html"><div class="ttname"><a href="structLinearSolver_1_1Richardson_1_1Richardson.html">LinearSolver::Richardson::Richardson</a></div><div class="ttdoc">A simple Richardson scheme for solving a system of linear equations .</div><div class="ttdef"><b>Definition:</b> Richardson.hpp:115</div></div>
<div class="ttc" id="astructLinearSolver_1_1multigrid_1_1Multigrid_html"><div class="ttname"><a href="structLinearSolver_1_1multigrid_1_1Multigrid.html">LinearSolver::multigrid::Multigrid</a></div><div class="ttdoc">A V-cycle geometric multgrid solver for linear equations .</div><div class="ttdef"><b>Definition:</b> Multigrid.hpp:117</div></div>
<div class="ttc" id="astructLinearSolver_1_1multigrid_1_1Tags_1_1MultigridLevel_html"><div class="ttname"><a href="structLinearSolver_1_1multigrid_1_1Tags_1_1MultigridLevel.html">LinearSolver::multigrid::Tags::MultigridLevel</a></div><div class="ttdoc">The multigrid level. The finest grid is always level 0 and the coarsest grid has the highest level.</div><div class="ttdef"><b>Definition:</b> Tags.hpp:164</div></div>
</div><!-- fragment --><p >The smoother can be used to construct an action list like this:</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Label&gt;</div>
<div class="line">  <span class="keyword">using</span> smooth_actions = <span class="keyword">typename</span> smoother::template solve&lt;</div>
<div class="line">      compute_operator_action&lt;typename smoother::operand_tag&gt;, Label&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> solve_actions =</div>
<div class="line">      tmpl::list&lt;compute_operator_action&lt;typename multigrid::fields_tag&gt;,</div>
<div class="line">                 <span class="keyword">typename</span> multigrid::template solve&lt;</div>
<div class="line">                     compute_operator_action&lt;typename smoother::fields_tag&gt;,</div>
<div class="line">                     smooth_actions&lt;LinearSolver::multigrid::VcycleDownLabel&gt;,</div>
<div class="line">                     smooth_actions&lt;LinearSolver::multigrid::VcycleUpLabel&gt;&gt;,</div>
<div class="line">                 <a class="code hl_struct" href="structParallel_1_1Actions_1_1TerminatePhase.html">Parallel::Actions::TerminatePhase</a>&gt;;</div>
<div class="ttc" id="astructParallel_1_1Actions_1_1TerminatePhase_html"><div class="ttname"><a href="structParallel_1_1Actions_1_1TerminatePhase.html">Parallel::Actions::TerminatePhase</a></div><div class="ttdoc">Terminate the algorithm to proceed to the next phase.</div><div class="ttdef"><b>Definition:</b> TerminatePhase.hpp:28</div></div>
</div><!-- fragment --><dl class="section user"><dt>Algorithm overview</dt><dd>Every iteration of the multigrid algorithm performs a V-cycle over the grid hierarchy. One V-cycle consists of first "going down" the grid hierarchy, from the finest to successively coarser grids, smoothing on every level ("pre-smoothing", can be controlled by the option <code><a class="el" href="structLinearSolver_1_1multigrid_1_1Tags_1_1EnablePreSmoothing.html" title="Enable pre-smoothing. A value of false means that pre-smoothing is skipped altogether (&quot;cascading mul...">LinearSolver::multigrid::Tags::EnablePreSmoothing</a></code>), and then "going up" the grid hierarchy again, smoothing on every level again ("post-smoothing"). When going down, the algorithm projects the remaining residual of the smoother to the next-coarser grid, setting it as the source for the smoother on the coarser grid. When going up again, the algorithm projects the solution of the smoother to the next-finer grid, adding it to the solution on the finer grid as a correction. The bottom-most coarsest grid (the "tip" of the V-cycle) may skip the post-smoothing, so the result of the pre-smoother is immediately projected up to the finer grid (controlled by the <code><a class="el" href="structLinearSolver_1_1multigrid_1_1Tags_1_1EnablePostSmoothingAtBottom.html" title="Enable post-smoothing on the coarsest grid. A value of false means that post-smoothing is skipped on ...">LinearSolver::multigrid::Tags::EnablePostSmoothingAtBottom</a></code> option). On the top-most finest grid (the "original" grid that represents the overall solution) the algorithm applies the smoothing and the corrections from the coarser grids directly to the solution fields. </dd></dl>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/ParallelAlgorithms/LinearSolver/Multigrid/Multigrid.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceLinearSolver.html">LinearSolver</a></li><li class="navelem"><a class="el" href="namespaceLinearSolver_1_1multigrid.html">multigrid</a></li><li class="navelem"><a class="el" href="structLinearSolver_1_1multigrid_1_1Multigrid.html">Multigrid</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
