<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.9.3"/>
  <title>SpECTRE: PhaseChange Struct Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <script type="text/javascript" src="spectre.js"></script>
  <script type="text/javascript" src="doxygen-navtree-hacks.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
  </script>
  </head>
  <body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <table cellspacing="0" cellpadding="0">
      <tbody>
        <tr style="height: 56px;">
          <td id="projectalign" style="padding-left: 0.5em;">
            <div id="projectname">
              <a href="index.html">SpECTRE</a>
              &#160;<span id="projectnumber">v2023.06.19</span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structPhaseChange.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="structPhaseChange-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PhaseChange Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> objects determine the storage types and logic for moving between phases based on runtime data.  
 <a href="structPhaseChange.html#details">More...</a></p>

<p><code>#include &lt;PhaseChange.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa86bf0c8fdf6a15dc02a5fd3aac0e345"><td class="memItemLeft" align="right" valign="top"><a id="aa86bf0c8fdf6a15dc02a5fd3aac0e345" name="aa86bf0c8fdf6a15dc02a5fd3aac0e345"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PhaseChange</b> (CkMigrateMessage *msg)</td></tr>
<tr class="separator:aa86bf0c8fdf6a15dc02a5fd3aac0e345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b42c2aa159c3b722e3ab88950223520"><td class="memItemLeft" align="right" valign="top"><a id="a1b42c2aa159c3b722e3ab88950223520" name="a1b42c2aa159c3b722e3ab88950223520"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>WRAPPED_PUPable_abstract</b> (<a class="el" href="structPhaseChange.html">PhaseChange</a>)</td></tr>
<tr class="separator:a1b42c2aa159c3b722e3ab88950223520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08f0e183e71fb5807bb43650bbdca44b"><td class="memTemplParams" colspan="2"><a id="a08f0e183e71fb5807bb43650bbdca44b" name="a08f0e183e71fb5807bb43650bbdca44b"></a>
template&lt;typename ParallelComponent , typename DbTags , typename Metavariables , typename ArrayIndex &gt; </td></tr>
<tr class="memitem:a08f0e183e71fb5807bb43650bbdca44b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>contribute_phase_data</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; db::DataBox&lt; DbTags &gt; * &gt; box, <a class="el" href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache</a>&lt; Metavariables &gt; &amp;cache, const ArrayIndex &amp;array_index) const</td></tr>
<tr class="memdesc:a08f0e183e71fb5807bb43650bbdca44b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data from all <code>participating_components</code> to the Main chare for determining the next phase. <br /></td></tr>
<tr class="separator:a08f0e183e71fb5807bb43650bbdca44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd70e823884c684b9e96f4fe96a1383"><td class="memTemplParams" colspan="2"><a id="a8dd70e823884c684b9e96f4fe96a1383" name="a8dd70e823884c684b9e96f4fe96a1383"></a>
template&lt;typename... DecisionTags, typename Metavariables &gt; </td></tr>
<tr class="memitem:a8dd70e823884c684b9e96f4fe96a1383"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt; <a class="elRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair</a>&lt; <a class="el" href="group__ParallelGroup.html#ga027a2e60b10898507f92ba7290f0ba61">Parallel::Phase</a>, <a class="el" href="namespacePhaseControl.html#aca18e7afb80938d20c0a73b2efd903e0">PhaseControl::ArbitrationStrategy</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>arbitrate_phase_change</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; <a class="el" href="classtuples_1_1TaggedTuple.html">tuples::TaggedTuple</a>&lt; DecisionTags... &gt; * &gt; phase_change_decision_data, const <a class="el" href="group__ParallelGroup.html#ga027a2e60b10898507f92ba7290f0ba61">Parallel::Phase</a> current_phase, const <a class="el" href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache</a>&lt; Metavariables &gt; &amp;cache) const</td></tr>
<tr class="memdesc:a8dd70e823884c684b9e96f4fe96a1383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a phase request and <code><a class="el" href="namespacePhaseControl.html#aca18e7afb80938d20c0a73b2efd903e0" title="The possible options for instructing the Main chare in deciding the next phase to jump to.">PhaseControl::ArbitrationStrategy</a></code> based on aggregated <code>phase_change_decision_data</code> on the Main Chare. <br /></td></tr>
<tr class="separator:a8dd70e823884c684b9e96f4fe96a1383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb99399d21f9c0ebe5af018495c716a2"><td class="memTemplParams" colspan="2"><a id="aeb99399d21f9c0ebe5af018495c716a2" name="aeb99399d21f9c0ebe5af018495c716a2"></a>
template&lt;typename Metavariables , typename... Tags&gt; </td></tr>
<tr class="memitem:aeb99399d21f9c0ebe5af018495c716a2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>initialize_phase_data</b> (const <a class="el" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt; <a class="el" href="classtuples_1_1TaggedTuple.html">tuples::TaggedTuple</a>&lt; Tags... &gt; * &gt; phase_change_decision_data) const</td></tr>
<tr class="memdesc:aeb99399d21f9c0ebe5af018495c716a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the <code>phase_change_decision_data</code> on the main chare to starting values. <br /></td></tr>
<tr class="separator:aeb99399d21f9c0ebe5af018495c716a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p ><code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> objects determine the storage types and logic for moving between phases based on runtime data. </p>
<p >The phase control flow must have the cooperation of each parallel component, but make phase decisions centrally so that at any point, all components are in the same phase. The operations needed by the parallel components and by the Main chare, are:</p>
<ol type="1">
<li><a class="el" href="namespaceParallel.html" title="Functionality for parallelization.">Parallel</a> components must select and/or compute the runtime data necessary for choosing the next phase, then contribute it to a global reduction to the Main component. The components must then halt at a globally-valid state for the phase change. The requirements for the state will vary depending on the phase choices, so triggers must be selected appropriately for the <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> object. For instance, selecting a common slab will usually represent a globally well-behaved state for a <code><a class="el" href="structDgElementArray.html" title="The parallel component responsible for managing the DG elements that compose the computational domain...">DgElementArray</a></code>.</li>
<li>On the Main chare, the <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> objects must use the collected reduction data, or other persistent data stored in <code>phase_change_decision_data</code> to decide on a phase to request and an <code><a class="el" href="namespacePhaseControl.html#aca18e7afb80938d20c0a73b2efd903e0" title="The possible options for instructing the Main chare in deciding the next phase to jump to.">PhaseControl::ArbitrationStrategy</a></code> to determine how to resolve multiple simultaneous requests. Additionally, the <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> objects must specify initialization functions to set the starting state of the tags in <code>phase_change_decision_data</code> for which they are responsible.</li>
</ol>
<p >In addition to the <code>options</code> type alias and <code>static constexpr <a class="el" href="namespaceOptions.html#aa61c7f41f21afa7646811456f673be89" title="The string used in option structs.">Options::String</a> help</code> variable needed to be option-creatable, a derived class of <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> must specify the type aliases:</p><ul>
<li><code>argument_tags</code>: A <code>tmpl::list</code> of tags from the <a class="el" href="group__DataBoxGroup.html">DataBox</a> to be passed to <code>contribute_phase_data_impl</code> as const references.</li>
<li><code>return_tags</code>: A <code>tmpl::list</code> of mutable tags from the <a class="el" href="group__DataBoxGroup.html">DataBox</a> to be passed to <code>contribute_phase_data_impl</code> as <code><a class="el" href="classgsl_1_1not__null.html" title="Require a pointer to not be a nullptr">gsl::not_null</a></code> pointers. This should be used only for tags that may be altered during the <code>contribute_phase_data_impl</code> function.</li>
<li><code>phase_change_tags_and_combines</code>: A <code>tmpl::list</code> of tags for populating the <code>phase_change_decision_data</code> in the Main chare. Each tag in this list must also define a <code>combine_method</code> and a <code>main_combine_method</code> for performing the aggregation during reduction.</li>
<li><code>participating_components</code> (templated on <code>Metavariables</code>): A <code>tmpl::list</code> of components that contribute data during this reduction. This can be used to screen out components that will not have the necessary information to contribute to the reduction. If all components should participate, this type alias can be set to simply <code>typename Metavariables::component_list</code>.</li>
</ul>
<p >And member functions with signatures:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... DecisionTags&gt;</div>
<div class="line"><span class="keywordtype">void</span> initialize_phase_data_impl(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt;<a class="code hl_class" href="classtuples_1_1TaggedTuple.html">tuples::TaggedTuple&lt;DecisionTags...&gt;</a>*&gt;</div>
<div class="line">        phase_change_decision_data) <span class="keyword">const</span>;</div>
<div class="ttc" id="aclassgsl_1_1not__null_html"><div class="ttname"><a href="classgsl_1_1not__null.html">gsl::not_null</a></div><div class="ttdoc">Require a pointer to not be a nullptr</div><div class="ttdef"><b>Definition:</b> Gsl.hpp:183</div></div>
<div class="ttc" id="aclasstuples_1_1TaggedTuple_html"><div class="ttname"><a href="classtuples_1_1TaggedTuple.html">tuples::TaggedTuple</a></div><div class="ttdoc">An associative container that is indexed by structs.</div><div class="ttdef"><b>Definition:</b> TaggedTuple.hpp:261</div></div>
</div><!-- fragment --><ul>
<li>Must set all tags in <code>phase_change_tags_and_combines</code> to useful initial states in the <code>phase_change_decision_data</code>.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ParallelComponent, <span class="keyword">typename</span> ArrayIndex&gt;</div>
<div class="line"><span class="keywordtype">void</span> contribute_phase_data_impl(</div>
<div class="line">    [DataBox <span class="keywordflow">return</span> tags...], [DataBox argument tags...],</div>
<div class="line">    <a class="code hl_class" href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache&lt;Metavariables&gt;</a>&amp; cache,</div>
<div class="line">    <span class="keyword">const</span> ArrayIndex&amp; array_index) <span class="keyword">const</span>;</div>
<div class="ttc" id="aclassParallel_1_1GlobalCache_html"><div class="ttname"><a href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache</a></div><div class="ttdoc">A Charm++ chare that caches constant data once per Charm++ node or non-constant data once per Charm++...</div><div class="ttdef"><b>Definition:</b> GlobalCache.hpp:374</div></div>
</div><!-- fragment --><ul>
<li>Should send any data relevant for the associated phase change decision made in <code>arbitrate_phase_change_impl</code> to the Main chare via function <code><a class="el" href="namespaceParallel.html#ab3efd47ce7ceacc271fd4f6809230deb" title="Send data from a parallel component to the Main chare for making phase-change decisions.">Parallel::contribute_to_phase_change_reduction</a></code>.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... DecisionTags, <span class="keyword">typename</span> Metavariables&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a>&lt;</div>
<div class="line">    <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair&lt;Parallel::Phase, ArbitrationStrategy&gt;</a>&gt;</div>
<div class="line">arbitrate_phase_change_impl(</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classgsl_1_1not__null.html">gsl::not_null</a>&lt;<a class="code hl_class" href="classtuples_1_1TaggedTuple.html">tuples::TaggedTuple&lt;DecisionTags...&gt;</a>*&gt;</div>
<div class="line">        phase_change_decision_data,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_enumeration" href="group__ParallelGroup.html#ga027a2e60b10898507f92ba7290f0ba61">Parallel::Phase</a> current_phase,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classParallel_1_1GlobalCache.html">Parallel::GlobalCache&lt;Metavariables&gt;</a>&amp; cache) <span class="keyword">const</span>;</div>
<div class="ttc" id="agroup__ParallelGroup_html_ga027a2e60b10898507f92ba7290f0ba61"><div class="ttname"><a href="group__ParallelGroup.html#ga027a2e60b10898507f92ba7290f0ba61">Parallel::Phase</a></div><div class="ttdeci">Phase</div><div class="ttdoc">The possible phases of an executable.</div><div class="ttdef"><b>Definition:</b> Phase.hpp:40</div></div>
<div class="ttc" id="aoptional_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/optional.html">std::optional</a></div></div>
<div class="ttc" id="apair_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair</a></div></div>
</div><!-- fragment --><ul>
<li>Should examine the collected data in <code>phase_change_decision_data</code> and optionally return a <code><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/pair.html">std::pair</a></code> with the desired <code><a class="el" href="group__ParallelGroup.html#ga027a2e60b10898507f92ba7290f0ba61" title="The possible phases of an executable.">Parallel::Phase</a></code> and an <code><a class="el" href="namespacePhaseControl.html#aca18e7afb80938d20c0a73b2efd903e0" title="The possible options for instructing the Main chare in deciding the next phase to jump to.">PhaseControl::ArbitrationStrategy</a></code> indicating a method for arbitrating multiple simultaneous requests. Alternatively, it may return <code>std::nullopt</code> to abstain from the phase decision. The <code>arbitrate_phase_change_impl</code> may (and often will) mutate the <code>phase_change_decision_data</code>. For instance, it may be desirable to 'reset' the data to allow for future jumps associated with the same <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code>, or the <code><a class="el" href="structPhaseChange.html" title="PhaseChange objects determine the storage types and logic for moving between phases based on runtime ...">PhaseChange</a></code> will describe multiple changes in sequence, and the state of that sequential process can be recorded in <code>phase_change_decision_data</code>. </li>
</ul>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/Parallel/PhaseControl/PhaseChange.hpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structPhaseChange.html">PhaseChange</a></li>
    <li class="footer">
    &copy; Copyright 2017 - 2023
    <a href="https://black-holes.org">SXS Collaboration</a>,
    <a href="LICENSE.txt" target="_blank">
    <span class="hidden-xs">Distributed under the</span>
    MIT License</a>
  </ul>
</div>
</body>
</html>
